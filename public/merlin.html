<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat with Merlin</title>
    <style>
        /* General Styles */
        body {
            margin: 0;
            height: 100vh;
            overflow: hidden;
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
        }

        /* Chatbot Floating Button */
        #chatbot-icon-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            cursor: pointer;
            z-index: 1000;
        }

        #chatbot-button {
            background: transparent;
            border: none;
            outline: none;
        }

        #chatbot-button img {
            width: 60px;
            height: auto;
            display: block;
        }

        /* Chatbot Container */
        #webchat-container {
            position: relative;
            width: 100%;
            height: 100%;
        }

        /* Hide Floating Button (if not needed) */
        .bpFab {
            display: none;
        }

        /* Bot UI Fullscreen */
        .bpWebchat {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            width: 100% !important;
            height: 100vh !important;
            max-height: calc(100vh - env(safe-area-inset-bottom)) !important; /* Adjust for Safari bottom UI */
            position: fixed !important;
            bottom: 0 !important;
            right: 0 !important;
            z-index: 100000 !important;
/*
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            bottom: 0 !important;
*/            
        }

        /* Mobile Styles */
        @media (max-width: 768px) {
            #webchat-container {
                width: 100vw;
                height: 100vh;
            }

            .bpWebchat {
                width: 100vw !important;
                height: 100vh !important;
                border-radius: 0 !important;
            }
        }
    </style>
</head>

<body>

    <div id="webchat-container"></div>

    <script>
        (function loadBotpress() {
            var script = document.createElement("script");
            script.src = "https://cdn.botpress.cloud/webchat/v2.2/inject.js?v=" + new Date().getTime();
            script.async = true;
            script.defer = true;

            script.onload = function () {
                console.log("‚úÖ BotPress script loaded successfully.");

                window.botpress.on("webchat:ready", () => {
                    console.log("‚úÖ BotPress webchat is ready. Opening bot...");
                    window.botpress.open();
                    setTimeout(() => {
                        console.log("üîÑ Trying to show chatbot...");
                        window.botpress.open();
                    }, 2000);
                });

                window.botpress.init({
                    "botId": "1fde9b90-743e-4d6f-b30d-b2429e2e349a",
                    "configuration": {
                        "botName": "Merlin",
                        "botAvatar": "https://1010public.s3.us-east-2.amazonaws.com/dwd_favicon.png",
                        "color": "#3B82F6",
                        "variant": "solid",
                        "themeMode": "light",
                        "fontFamily": "inter",
                        "radius": 1,
                        "showPoweredBy": false,
                        "allowFileUpload": false,
                        "showCloseButton": false,
                        "closeOnEscape": false,
                        "stylesheet": "https://webchat-styler-css.botpress.app/prod/code/3fcd3e4e-d5bc-4bf5-8699-14b621b3ada2/v31782/style.css?v=" + new Date().getTime(),
                        "layout": {
                           "inputBottomPadding": "20px"  // Moves chat input up
                        }                        
                    },
                    "clientId": "5fddb6b1-f926-4b7a-b7cf-bdff8041f916"
                });
            };

            script.onerror = function () {
                console.error("‚ö†Ô∏è BotPress script failed to load. Retrying in 3 seconds...");
                setTimeout(loadBotpress, 3000);
            };

            document.body.appendChild(script);
        })();
    </script>


</body>

</html>